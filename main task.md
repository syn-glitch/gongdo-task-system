# 업무 관리 시스템 로드맵

## 🤖 핵심 AI 에이전트 상세 가이드
본 내용은 별도 문서([JUDY_AI_AGENT.md](JUDY_AI_AGENT.md))로도 관리되고 있습니다.

---

# 🤖 Judy AI Agent: 공도 업무 관리 지능형 비서

## 📋 문서 개요
본 문서는 공도 업무 관리 시스템의 1호 AI 에이전트인 **주디(Judy)**의 현재 개발 현황, 채널(슬랙 vs 웹 워크스페이스)별 역할 분리 전략, 그리고 향후 아키텍처 개선 방향을 정리한 문서입니다.
- **작성 목적**: 내부 개발자 간의 시스템 이해도 제고 및 향후 서버 고도화(Scale-up) 시점의 마일스톤 및 논의 기준으로 활용

---

## 🏗 현재 개발 환경 및 아키텍처 (GAS 기반)

### 시스템 구성
- **백엔드/인프라**: Google Apps Script (GAS) 서버리스 환경
- **데이터베이스**: Google Sheets (업무/사용자 DB 마스터)
- **저장소**: Google Drive (마크다운 메모/아카이브 저장)
- **AI 엔진**: Claude 3 (Claude-Sonnet-4-20250514) API
- **프론트엔드 채널**: Slack (명령어 및 즉각 알림), Web (SPA 형태의 Judy Workspace)

### 현재 GAS 개발 환경의 장/단점 및 개선 방향

#### ✅ 장점 (현재 단계의 강점)
1. **운영 비용 제로(Zero)**: 구글 인프라 내에서 동작하므로 별도의 호스팅 및 서버 유지비가 발생하지 않습니다.
2. **쉬운 데이터 접근성**: 기획자나 운영자도 직접 구글 시트를 통해 DB를 열람하고 수정할 수 있는 직관적인 환경을 제공합니다.
3. **신속한 프로토타이핑**: 복잡한 서버 구축 없이 스크립트 작성만으로 슬랙 봇과 웹앱을 동시에 빠르게 배포할 수 있습니다.

#### ⛔ 단점 및 한계점
1. **슬랙 3초 타임아웃 룰**: 슬랙 API는 무조건 3초 내에 `HTTP 200 OK` 응답을 요구하나, GAS는 비동기(Async) 백그라운드 처리가 불가능한 동기(Sync) 방식이라 무거운 AI 연산(예: 컨텍스트 파싱) 시 무조건 에러가 발생합니다.
2. **성능 및 확장성 제약**: 데이터베이스 대신 구글 시트를 사용하므로, 데이터가 1,000건 이상 누적되거나 동시 접속자가 늘어날 경우 읽기/쓰기 병목 현상과 심각한 레이턴시 지연이 발생합니다.

#### 💡 향후 개선 방향 (서버 고도화)
- **1단계 (임시 방편)**: Cloudflare Workers 등 무료 엣지(Edge) 서버를 미들웨어로 두어 슬랙의 3초 룰 응답만 대신 처리해주고, 실제 연산은 GAS 트리거에 던지는 방안.
- **2단계 (완전 독립)**: Node.js (Express/NestJS) 기반 백엔드 및 PostgreSQL(또는 Firebase)을 도입하여 비동기 처리의 근본적 해결과 AI 에이전트의 완전 능동화 구현 (업무량 매일 500건 초과 시점 권장).

---

## 🧠 AI 기능 현황 및 로드맵

### ✅ 현재 개발 완료된 AI 기능 (Current Capabilities)
- **✨ AI 요약 (Note)**: 메모 조회 시 상단 버튼을 통해 긴 본문을 한눈에 볼 수 있게 요약 (Claude API 연동)
- **✨ AI 업무 추출 (Workspace 연동)**: 노트 에디터에서 텍스트 드래그 시 🐰 플로팅 버튼이 나타나며, 클릭 시 AI가 업무명/마감일/상세내용을 자동 파싱하여 등록 모달에 채워줌.
- **✨ AI 리포팅**: 일간/주간 완료 업무 데이터를 바탕으로 요약 리포트를 생성하여 슬랙으로 자동 전송.
- **✨ 스마트 검색**: 마크다운 파일을 순회하여 키워드 매칭 후 결과를 표출하는 AI RAG 기반 로직.

### 🚀 향후 추가/확장 예정인 AI 기능 (Future Capabilities)
주디를 "내 지시에 따르는 도구"에서 **"먼저 알아서 행동하는 동료"**로 진화시키는 단계입니다:

- **🗣️ 슬랙 자연어 업무 등록**: 슬랙 DM에 "넷마블 기획서 금요일까지"라고만 쳐도 AI가 자동으로 파싱하여 등록 버튼을 제안함.
- **⏰ 맥락 인지 스마트 리마인더 & 업무 트래킹**: 마감 임박 업무나 3일 이상 방치된 업무를 감지해 "넛지(Nudge)" 알림을 보냅니다. 또한, 업무 상태(대기→진행→완료) 변경 시간에 기반한 **업무 트래킹(Time Tracking)** 기능이 추가되어, 일간/주간/월간 단위 대시보드에서 내가 어떤 업무에 실제 시간을 많이 사용했는지 직관적으로 파악할 수 있습니다.
- **💬 대화형 업무 상태 변경**: "넷마블 기획서 완료했어"라고 채팅하면 AI가 업무를 찾아 상태를 업데이트하고 오늘의 진척도를 보고함.
- **📝 AI 주디와 함께 작성하는 지식 회고 노트 (Retrospective)**: 
  - 업무가 특정 상태(성공적 완료, 지연 완료, 보류, 도움 요청 등)로 종료되면, 기획서나 태스크 문서를 만들듯 **회고 문서를 작성할 수 있는 전용 공간**이 활성화됩니다.
  - 여기에 기록된 회고 노트 DB는 향후 비슷한 실수나 어려움에 봉착했을 때 강력한 진가를 발휘합니다. 사용자가 검색하거나 AI에게 도움을 요청하면, **과거 회고 노트를 기반으로 주디가 솔루션과 새로운 대안을 선제적으로 제공**해 줍니다.

---

## �🚦 채널별 AI 사용 전략과 역할 분리 (현재 기준)

현재 GAS 환경의 태생적 한계(3초룰 및 동기 지연)로 인해 AI 연산 과정에서 지속적인 충돌이 발생합니다. 이를 회피하고 최적의 UX를 제공하기 위해 **슬랙봇 영역과 웹 워크스페이스 영역의 역할을 철저히 이원화**합니다.

### 1. 💬 주디 슬랙봇 (Slack Bot) 영역
**[목표]: "가벼운 접수 창구 및 확성기 (Quick Input & Push Notification)"**

무거운 AI 분석(요약, 파싱)을 슬랙에서 완전히 배제하여 타임아웃 오류를 방지합니다.

- **현재 사용 방법**:
  - `/주디` 명령어: 정형화된 데이터 입력을 위한 모달(팝업)을 띄워 시트에 즉시 등록(AI 연산 없음).
  - 메시지 메뉴 (점 3개): 대화를 그대로 긁어와서 태스크 폼에 채워주는 역할.
  - 매직 링크 발급 (`/주디 내업무`, `/주디 노트`): 웹으로 넘어가기 위한 1회용 로그인 링크 셔틀.
- **향후 개발 방향**:
  - 서버 고도화 이전까지는 타임아웃을 유발하는 AI 자유 대화(DM 질의응답) 기능을 의도적으로 제한하거나, 사용자에게 웹 워크스페이스로 이동하도록 가이드하는 봇 로직을 유지합니다.
  - 매일 아침 리포트(모닝 브리핑), 타인 지정 시 담당자 알림 등 일방향 **푸시(Push)** 기능 고도화에 시스템 역량을 집중합니다.

### 2. 🌐 주디 워크스페이스 (Web Workspace) 영역
**[목표]: "AI 연산 및 심층 관리 공간 (Deep Processing & Management)"**

웹 환경은 3초 타임아웃 룰의 제약을 받지 않으므로(서버 응답 최장 6분 대기 가능), Claude AI의 무거운 연산 로직을 이곳에 몰아줍니다.

- **현재 사용 방법**:
  - **✨ AI 핵심 업무 내용 추출**: 노트 에디터에서 긴 회의록의 일부분을 드래그하면 화면 상단에 🐰 플로팅 버튼이 노출됩니다. 누르면 넉넉히 5~10초 동안 AI가 문단을 파싱하여 모달 입력폼에 내용(제목/마감일/상세)을 예쁘게 스플릿하여 채워줍니다.
  - **✨ 과거 내용 스마트 요약**: 긴 아카이브 문서를 불어왔을 때 상단의 팝업 버튼을 눌러 핵심 맥락을 요약받습니다.
  - **📊 통합 대시보드 상태 관리**: 상태(진행/대기)를 드롭다운으로 즉시 변경하고 현황을 넓게 봅니다.
- **향후 개발 방향**:
  - 현재 단방향 요약/추출에 그치는 AI 액션을, 텍스트 에디터 안쪽에서 "AI에게 질문하기" 혹은 특정 영역을 지정하고 "여기에 어울리는 기획안 목차 작성해 줘" 등 **양방향 프롬프팅 툴**로 진화시킬 계획입니다.

---

## 🎯 요약 및 결론 
현재의 이원화 채널 전략은 인프라 한계 타개와 사용자 경험(UX) 최적화라는 두 마리 토끼를 잡기 위한 최선의 과도기적 아키텍처입니다.
- **명확한 규율**: *"슬랙에서는 가볍게 확인하고 넘기고, 무거운 일은 무조건 딥 다이브(웹)에서 한다."*
- 개발 논의 시, 새로운 기능(예: 자연어 대화형 등록)이 요구될 때 이 기능이 가벼운 알림 수신형(Slack)에 적합한지, 무거운 연산형(Web)에 적합한지 판단하는 기준 문서를 삼고자 합니다.

---

## 1단계: 기반 구축 - 구글 스프레드시트 데이터베이스 설정 <!-- id: 1 -->
- [x] 시트 구조 정의 (업무, 프로젝트, 팀원) <!-- id: 2 -->
- [x] `Tasks` (업무) 시트 생성 (ID, 상태, 프로젝트, 내용, 담당자, 날짜 등) <!-- id: 3 -->
- [x] `Users` (팀원) 및 `Projects` (프로젝트) 참조 시트 생성 <!-- id: 4 -->
- [x] ID 생성 및 타임스탬프 관리를 위한 기본 Google Apps Script (GAS) 구현 <!-- id: 5 -->

## Git 및 문서 관리 (Phase 1.5) <!-- id: 25 -->
- [x] 프로젝트 파일 및 문서 Git 커밋 <!-- id: 26 -->
- [x] GitHub 원격 저장소 생성 및 푸시 ([링크](https://github.com/syn-glitch/gongdo-task-system)) <!-- id: 27 -->

## 2단계: 슬랙 연동 - 알림 시스템 <!-- id: 6 -->
- [x] 슬랙 앱 생성 및 권한 설정 <!-- id: 7 -->
- [x] 슬랙으로 메시지를 보내기 위한 Incoming Webhook (또는 Bot Token) 설정 <!-- id: 8 -->
- [x] 새 업무 등록 시 슬랙으로 알림을 보내는 GAS 함수 작성 <!-- id: 9 -->
   - [x] 기본 전송 코드 작성
   - [x] 실전용 자동화 코드(DB연동) 작성 및 트리거 설정
   - [x] 데이터 유효성 검사(드롭다운) 적용으로 알림 정확도 향상

## 3단계: 슬랙 연동 - 업무 등록 (양방향) <!-- id: 10 -->
- [x] GAS에서 슬랙 상호작용 페이로드 처리 (doPost 생성) <!-- id: 13 -->
- [x] GAS를 '웹 앱'으로 배포하여 URL 획득 <!-- id: 28 -->
- [x] 슬랙 앱에서 슬래시 커맨드(예: `/주디`) 생성 및 URL 연결 <!-- id: 11 -->
- [x] 상세 업무 입력을 위한 슬랙 모달(Modal) UI 구축 <!-- id: 12 -->
   - 슬랙과 GAS 연동은 추후에 처리 예정 //용남이 직접 추가한 내용


## 4단계: 캘린더 동기화 <!-- id: 14 -->
- [x] GAS에서 캘린더 API 활성화 및 `calendar_sync.gs` 스크립트 작성 <!-- id: 15 -->
- [x] 동기화 로직 구현: 시트 행 업데이트 -> 캘린더 일정 생성/수정 <!-- id: 16 -->
- [x] 일정 삭제 또는 날짜 변경 처리 (상태 변경 반영) <!-- id: 17 -->

## 5단계: AI 리포팅 및 분석 <!-- id: 18 -->
- [x] GAS에서 Claude API 연결 설정 및 `ai_report.gs` 작성 <!-- id: 19 -->
- [x] 일간/주간 완료 업무 데이터를 가져오는 스크립트 작성 <!-- id: 20 -->
- [x] AI를 통한 요약 리포트 생성 및 슬랙 전송 <!-- id: 21 -->

## 6단계: 대시보드 및 최적화 <!-- id: 22 -->
- [x] 구글 스프레드시트 내 시각적 대시보드 및 차트 세팅 가이드 작성 <!-- id: 23 -->
- [x] 매일 아침 전송되는 "모닝 브리핑" 자동화 코드 및 트리거 스위치 구현 <!-- id: 24 -->

## 7단계: 메모장 (Judy Note) UI/UX 고도화 및 AI 요약
- [x] `judy_note.html` CSS 구조 개편 (CSS Variables 도입 및 Light Mode/Dark Mode 지원)
- [x] 좌측 사이드바(폴더 구조) 및 우측 에디터 영역 2단 레이아웃 구현
- [x] `drive_archive.gs`에 아카이브 트리 파싱 백엔드 함수 (`getArchivedMemos`) 추가
- [x] 프론트엔드 연동 및 사이드바 내 폴더 목록 클릭 이벤트 구현 (읽기 모드 전환)
- [x] 메모 조회 영역 상단에 AI 요약 버튼 및 UI 오버레이 구현
- [x] `web_app.gs` 및 AI 로직 (`summarizeMemoContent`) 추가

## 8단계: 🚀 향후 고도화 계획 (Future Enhancements)
- [x] **특정 단어 및 단어 전체 검색 기능 (Global Search)**
  - 모든 마크다운 파일을 순회하여 키워드 매칭 후 사이드바나 에디터에 결과 표출 (AI RAG 통합 로직 기반)
- [x] **슬랙 기반 챗봇 라우팅 및 빠른 검색 (Slack Intent Routing)**
  - 슬랙 봇 DM 수신 시 메시지 의도 판별(기반: 키워드) 로직 추가
  - 메모 단순 저장 시 불필요한 AI 답변(`processAiChatSync`) 완전 차단
  - "오늘 작성 메모 보여줘" 검색 의도시 금일 날짜의 메모를 조회하여 슬랙으로 깔끔하게 반환
- [ ] **에디터 내용 수정 가능 모드 (Edit Mode) & 덮어쓰기 기능**
  - **설명**: 현재 읽기 전용으로 불러와지는 과거 메모를 웹 에디터 안에서 직접 수정하고 저장할 수 있는 기능입니다.
  - **개발 방향**: 드라이브 마크다운 문서 내용을 파싱하여 특정 시간대 블록만 정확히 찾아 교체하고 파일 원본을 덮어쓰는(Update) 안전한 치환 로직 구현이 핵심입니다.
- [ ] **AI 챗봇과의 양방향 인터페이스 (AI Chat & Ask)**
  - **설명**: 단순한 '전체 글 요약' 팝업을 넘어서, 본문 내용 중 특정 구역을 지정하거나 하단 채팅창을 통해 AI와 티키타카(질의응답)를 나눌 수 있는 지능형 워크스페이스 기능입니다.
  - **개발 방향**: 에디터 내 동적 질문 API(`askAi`) 신설 및 노션(Notion)의 AI 블록과 유사한 양방향 채팅 버블 UI를 프론트엔드에 추가 구축해야 합니다.

## ✅ Judy Workspace 통합 (SPA 마이그레이션 — 완료)
> 📅 **완료일**: 2026-02-24 | 📖 상세 계획: [`implementation_plan_workspace.md`](implementation_plan_workspace.md)
> 💡 **목표**: 기존 `judy_note.html`과 `task_dashboard.html` 2개의 독립 웹앱을 `judy_workspace.html` 단일 SPA로 통합하여 원스톱 워크스페이스 구현

- [x] **Phase 1: SPA 셸 구축** — GNB, 탭 UI, 테마 전환, 라우팅 변경
- [x] **Phase 2: 주디 노트 모듈 이식** — 에디터, 사이드바, AI 요약 기능 전체 이식
- [x] **Phase 3: 대시보드 모듈 이식** — 테이블, 통계 카드, 모달 UI 전체 이식
- [x] **Phase 4: 유기적 연동 및 시너지 개발** — 드래그 선택 → 🐰 플로팅 버튼 → AI 업무 추출 → 모달 Pre-fill
- [x] **Phase 5: 최종 배포** — 슬랙 봇 링크 통합, Claude API 키 교체(`claude-sonnet-4-20250514`)

## [기각됨] 9단계: 동적 유저 관리 및 구글 SSO 보안 강화 (Dynamic User & Auth)
> 💡 **회고 및 기각 사유**: 
> 구글의 `Session.getActiveUser().getEmail()`을 활용한 SSO 인증을 시도했으나, 공도 팀의 **다중 도메인 환경(`@microchool.kr`, `@gongdo.kr`, `@gmail.com`)** 특성상 배포 권한을 외부로 개방해야 했음. 
> 이로 인해 최초 접속 시 발생하는 **구글 Oauth 권한 승인("이 앱이 정보에 접근하려 합니다") 팝업창**이 팀원들에게 상당한 UX 저하와 심리적 장벽을 유발할 것으로 판단되어 해당 접근 방식을 전면 백지화(Rollback) 하였음.

## 10단계: 슬랙 기반 매직 링크 보안 인증 (Slack Magic Link Auth)
> 📖 상세 계획: [`implementation_plan_phase10.md`](implementation_plan_phase10.md)
> 💡 **핵심 원리**: 신원이 이미 100% 보장된 '슬랙'을 인증(SSO) 창구로 역이용. 슬랙봇이 일회용 난수 토큰(Token)을 생성해 전용 만능 키(Magic Link)를 팀원 개인 DM으로 발급함. 구글 권한 팝업 없이 1초 만에 안전하고 완벽한 자동 로그인을 제공함.

### 개발
- [x] **Step 1: 슬랙 봇(`slack_command.gs`) 로직에 매직 링크 발급 기능 신설**
  - 팀원이 슬랙에서 `/주디 노트` 등 특정 액션 시, 봇이 16자리 난수 토큰 생성
  - `CacheService`를 이용해 토큰과 해당 팀원 실명을 **10분(600초)** 동안 단기 캐싱
  - 유저별 `?token=난수값` 형태의 파라미터가 붙은 접속 버튼을 개인 DM으로 전송
- [x] **Step 2: 웹 백엔드(`web_app.gs`)의 토큰 검증 시스템 개발**
  - `doGet(e)`에서 토큰 파라미터 존재 유무 확인
  - 백엔드에 토큰 유효성 검증 API(`validateToken`)를 만들어, 10분 이내의 유효 캐시인지 대조
  - 검증 성공 시 `이름` 반환 후, **보안을 위해 해당 토큰은 즉시 파기(1회용)**
- [x] **Step 3: 웹 프론트엔드(`judy_note.html`) 안전 렌더링 및 UI 방어**
  - 타인 이름 임의 선택 및 메모 열람 가능성이 있던 기존 드롭다운 완전 삭제
  - 토큰 검증에 성공한 본인 이름(Real Name)만 상단에 고정 렌더링
  - 토큰 변조(브루트포스) 및 만료 시 "잘못된 접근입니다" 풀스크린 오버레이 표출

### 검증
- [x] 슬랙봇이 준 링크로 접속 시 로그인 과정 없이 내 이름으로 즉시 노트 로드되는지 확인
- [x] 이미 방문했던 링크의 주소창 토큰 값 복사 후 시크릿 탭에서 붙여넣었을 때 **'만료된 링크' 차단(1회용 소멸)** 확인
- [x] 임의로 URL의 토큰 텍스트를 조작하여 엔터 입력 시 **타인 노트 우회 접속 불가(차단)** 확인

## [기각됨] 11단계: 마크다운 & 위지윅 하이브리드 에디터 도입 (TUI Editor)
> 📖 상세 계획: [`implementation_plan_phase11.md`](implementation_plan_phase11.md)
> 💡 **회고 및 기각 사유**: 심플한 기존 버전으로 롤백 요망.
> **기술적 이유**:
> 1. 모바일 등 다양한 기기에서의 호환성 문제 (TUI 에디터가 화면의 가로/세로 영역을 고정적으로 점유해 사용성 저하)
> 2. 구글 문서(Google Docs) 등 써드파티 문서 연동에 있어서 마크다운 에디터 엔진(TUI)으로 값을 불러와 다시 랜더링 하는 과정에서 원본 텍스트의 형태가 심하게 훼손됨.
> 3. 단순 텍스트 기록장을 원했던 초기의 기획 의도와 달리 지나치게 무겁고 복잡한 위지윅 에디터 방식이 유저 경험(UX)에 오히려 마이너스 요소로 작용함.



### 개발
- [x] **Step 1: 에디터 라이브러리 탑재 및 CSS 레이아웃 개편 (`judy_note.html`)**
  - `<textarea id="memoInput">` 완전 삭제 및 TUI 에디터 컨테이너(`<div id="editor">`) 생성
  - CDN을 통해 TUI 에디터 핵심 라이브러리 및 다크 테마 플러그인 연동
  - `judy_note_theme` 테마(Dark/Light) 변경 버튼과 에디터 내부 스킨(다크모드) 연동
- [x] **Step 2: 에디터 인스턴스 초기화 및 상태 관리 (JS)**
  - 페이지 로딩 시 마크다운+위지윅 탭이 보이는 에디터 뷰 마운트
  - 사이드바 과거 메모 클릭 시 단순 글자 뿌리기가 아닌 `editor.setMarkdown(text)`로 렌더링
  - 구글 드라이브 CORS 한계를 고려하여 이미지 복사/업로드(AddImageBlobHook) 기능 차단 처리 
- [x] **Step 3: 데이터 입출력 파이프라인 연결 연동**
  - 메모 일반 저장(`saveBtn`) 및 AI 추출(`extractBtn`) 시 에디터 내용을 `editor.getMarkdown()`으로 추출하여 백엔드 전송
  - AI 내용 요약(`summarizeBtn`) 시 에디터 본문을 타겟팅 하도록 로직 수정

### 검증
- [ ] 에디터 상단 툴바(굵게, 기울임, 표, 링크 등) 및 하단 탭(마크다운/위지윅) 전환이 정상 작동하는가?
- [ ] 노션처럼 블록 드래그 후 스타일 변경 뒤 저장했을 때, 구글 드라이브에 `.md` 원본 포맷으로 저장되는가?
- [ ] "✨ AI 내용 요약" 및 "✨ AI 업무 추출" 기능 사용 시 에디터에 적힌 내용이 백엔드로 정상 전달되는가?

## 12단계: 주디 노트 에디터 심플 버전 롤백 및 구글 문서 연동
> 📖 상세 계획: [`implementation_plan.md`](../../../.gemini/antigravity/brain/4b6fdd0e-4194-4fd1-b05a-0c007c5462e3/implementation_plan.md)
> 💡 **목표**: TUI 에디터를 제거하고 기존의 심플한 텍스트 에어리어로 복구하며, 구글 드라이브(MD 파일) 및 구글 문서(Doc) 모두에 기록 가능하도록 파싱 로직을 확장합니다.

- [x] `judy_note.html`에서 TUI 에디터 제거 후 심플 텍스트 에어리어 복구
- [x] `drive_archive.gs`에서 기존 `.md` 파일 파싱 외에 구글 문서(`application/vnd.google-apps.document`)에 저장된 내용도 동일하게 읽어올 수 있도록 수정
- [x] 주디 노트 폴더 클릭 시 구글 문서에 저장된 노트 버전 내역도 뷰어에 정상 출력되는지 확인

## 13단계: 모바일 반응형 디자인 (UI/UX) 최적화
- [x] 오프캔버스(Off-canvas) 방식 사이드바 구현 (`max-width: 768px`)
- [x] 헤더 영역 햄버거 메뉴 및 배경 반투명 오버레이 처리
- [x] 폴더 내 아이템 열람 및 '새 메모' 작성 시 모바일 사이드바 자동 닫기 편의 기능 추가
- [x] 모바일 사용성을 위해 하단 버튼 패딩 확대 및 단축키 힌트 숨김 처리
- [x] **모바일 최초 진입 시 에디터 자동 포커스 처리 (키보드 팝업)**
  - **설명**: 클로드 모바일 앱처럼 접속 즉시 가상 키보드가 하단에서 팝업되어 유저가 타자 칠 곳을 찾지 않고 즉시 텍스트 입력 상태가 되도록 유도.
  - **이슈 접근**: iOS 사파리와 크롬 등의 브라우저는 정책상 '사용자의 명시적인 터치(Gesture)' 없이 스크립트에 의한 `focus()` 호출만으로 키보드를 올리는 빈도를 엄격히 차단(또는 무시)하는 경향이 있음. 그러나 슬랙 등 특정 웹뷰(WebView) 링크 환경에선 편법적이나마 동작하게 강제할 수 있는 최적의 이벤트 바인딩 시점을 찾아야 함.
  - **결정 사항**: 편법적인 우회(Workaround) 스크립트는 추후 브라우저 업데이트 시 예기치 못한 크러시 버그를 유발할 위험성이 높다고 판단됨. 기술적인 강제 적용 대신, **"접속 후 화면의 입력창을 한 번 터치하면 키보드가 올라옵니다"**라는 팀원 안내/공지로 갈음하기로 결정하여 개발을 완료(기각 후 우회 해결) 처리함.

## 14단계: 분산형 개인 드라이브 저장 아키텍처 (Personal Drive Migration)
> 📖 상세 계획: [implementation_plan_phase14.md](implementation_plan_phase14.md)
- [ ] **팀원 개인 폴더 생성 및 권한 위임 로직 설계**
  - 웹앱 최초 진입 시 사용자의 'My Drive'에 전용 폴더 자동 생성 및 시스템 계정 공유
- [ ] **유저별 폴더 ID 매핑 시스템 구축**
  - 구글 시트 또는 Script Properties에 `User Email : Folder ID` 매핑 테이블 관리
- [ ] **동적 저장 아키텍처 적용**
  - `drive_archive.gs` 내 고정 ROOT 폴더 ID를 제거하고 사용자별 폴더로 동적 분기 저장 구현
- [ ] **기존 데이터 마이그레이션 가이드 작성**
  - 현재 마스터 계정에 쌓인 데이터를 각 개인 드라이브로 안전하게 옮기는 절차 안내

---

## 📌 향후 개발 로드맵 (우선순위 순)

> 아래는 실용성, 선행 조건(의존성), 팀원 체감효과를 기준으로 정리한 우선순위입니다.

### 🚀 최우선: AI 에이전트 핵심 기능 추가 (Proactive Agent Experience)
> 💡 **목표**: 주디를 "시키면 하는 도구"에서 **"먼저 알아서 행동하는 AI 동료"**로 진화시키는 핵심 3가지 기능
> 📅 **예정일**: 2026-02-24 저녁

#### Step 1: 🗣️ 슬랙 자연어 업무 등록
- [ ] 슬랙 DM에서 자연어 입력 시 Claude AI로 업무 자동 파싱 (기존 `ai_task_parser.gs` 재활용)
- [ ] 추출 결과를 슬랙 확인 메시지(버튼 포함)로 반환 → 사용자 승인 시 시트 자동 등록
- [ ] `slack_command.gs` 이벤트 라우팅에 "업무 등록 의도(Intent)" 판별 로직 추가
```
사용자: "넷마블 기획서 금요일까지 작성해야 해"
주디: "📋 업무를 등록할까요?
      • 제목: 넷마블 기획서 작성
      • 마감일: 2026-02-28
      [등록하기] [수정하기]"
```

#### Step 2: ⏰ 스마트 리마인더 & 마감 경고
- [ ] 매일 오전 트리거로 `Tasks` 시트 스캔 → 마감 D-1/D-Day 업무 감지
- [ ] 3일 이상 '대기' 상태 방치 업무 자동 넛지(Nudge) 알림
- [ ] 기존 모닝 브리핑에 **마감 경고 블록** 추가 (슬랙 개인 DM 발송)
```
주디: "🔔 오늘 주의할 업무:
      • ⚠️ '넷마블 기획서' 마감 D-1 (내일까지)
      • 💤 '전주 기획서 분리' 3일째 '대기' 상태
      오늘도 화이팅! 🐰"
```

#### Step 3: 💬 대화형 업무 상태 변경
- [ ] 슬랙 DM에서 "완료/시작/보류" 키워드 + 업무명 감지 → 시트 상태 자동 변경
- [ ] 변경 완료 후 확인 메시지 + 오늘의 업무 진척 현황 요약 자동 제공
- [ ] 업무명 모호 시 후보 목록 제시 → 사용자 선택 플로우 구현
```
사용자: "넷마블 기획서 완료했어"
주디: "✅ '넷마블 기획서 작성' 완료 처리했습니다!
      오늘 완료: 3건 / 남은 업무: 5건 🐰"
```

### 🥇 우선순위 1: 프로젝트 분류 체계 고도화 (기존 16단계)
> 📖 상세 계획: [implementation_plan_phase16.md](implementation_plan_phase16.md)
> ⚠️ **17단계·20단계의 선행 조건** — 정형화된 데이터 구조가 필수
- [ ] **Projects 시트 속성 확장 및 AI 학습 메타데이터 추가**
  - 프로젝트 설명(Description), 상태, 우선순위 필드 신설 및 AI 프롬프트 연동
- [ ] **구조적 업무 ID (Structured Task ID) 시스템 구현**
  - `[프로젝트코드]-[일련번호]` 형태의 자동 ID 생성 로직 및 기존 데이터 마이그레이션
- [ ] **입력 UI 통제 및 정형 데이터 확보 (Selection over Collection)**
  - 슬랙 및 웹 앱 업무 등록 시 프로젝트명을 드롭다운(선택형)으로 강제화
- [ ] **AI 기반 컨텍스트 업무 분석 및 자동화 워크플로우 연동**
  - 프로젝트 코드별 맞춤형 자동화 규칙 적용 및 AI 전문 분석 리포트 강화

### 🥈 우선순위 2: 일정 캘린더 직접 등록 (기존 18단계)
> 📖 상세 계획: [implementation_plan_phase18.md](implementation_plan_phase18.md)
> ⚠️ 기존 4단계(마감일→종일 이벤트)와 달리 시간 지정 이벤트
- [ ] **슬랙 일정 등록 인터페이스 구현 (`/주디 일정`)**
  - 일정 유형(회의/외근/미팅), 날짜, 시작~종료 시간, 장소 입력 모달 구축
- [ ] **캘린더 시간 지정 이벤트 등록 백엔드 (`calendar_schedule.gs` 신규)**
  - 기존 종일 이벤트와 분리된 `createEvent()` 기반 시간 이벤트 생성 로직
- [ ] **`Schedules` 시트 신설 및 일정 데이터 관리**
  - Tasks 시트와 독립된 일정 이력 관리 및 AI 리포트 교차 분석 기반 제공
- [ ] **일정 리마인더 및 팀 일정 조회 기능**
  - 일정 30분 전 슬랙 알림 자동 발송 및 `/주디 팀 일정` 조회 연동

### 🥉 우선순위 3: 업무 라이프사이클 고도화 (기존 20단계)
> 📖 상세 계획: [implementation_plan_phase20.md](implementation_plan_phase20.md)
- [ ] **슬랙 모달 기반 업무 상태 관리**
  - `/주디 내 업무` → 업무 선택 → 모달에서 상태(시작/대기/보류/완료) 원스톱 변경 → 시트 자동 반영
- [ ] **업무 시간 트래킹 (Time Tracking)**
  - 시작 시 예상 소요 시간 입력 + 타임스탬프 자동 기록, 완료 시 실제 소요 시간 자동 계산
- [ ] **업무 완료 회고 시스템 (Retrospective)**
  - 완료 전환 시 회고 모달 자동 팝업 (잘된 점, 어려웠던 점, 지연 사유, 한 줄 메모)
- [ ] **상태 기반 스마트 리마인더**
  - 대기 3일, 진행중 2일 무변화 자동 알림 + 마감 D-1/D-Day 알림 + 사용자 직접 설정 리마인드

### 우선순위 4: 역할 기반 업무 뷰 및 팀원 협업 (기존 17단계)
> 📖 상세 계획: [implementation_plan_phase17.md](implementation_plan_phase17.md)
> 📌 **선행 조건**: 우선순위 1 완료 (정형화된 데이터 구조 필수)
- [ ] **Users 시트 확장 및 역할/팀 체계 도입**
  - 역할(대표/팀장/팀원), 소속 팀, 기본 프로젝트 필드 추가 및 Config 시트 신설
- [ ] **역할 기반 업무 뷰 시스템 구현**
  - `/주디 내 업무`(개인), `/주디 팀 현황`(팀장), `/주디 전사 현황`(대표) 필터링 로직
- [ ] **팀원 간 업무 요청/위임/완료 알림 워크플로우 구축**
  - `/주디 요청 @팀원 업무내용` 자동 등록 및 상태 변경 시 요청자에게 알림 발송
- [ ] **모닝 브리핑 개인화 (역할별 맞춤 리포트)**
  - 팀원/팀장/대표에게 각각 다른 수준의 업무 요약 자동 발송

### 🥈 우선순위 2: ⏱️ 업무 시간 트래킹 및 시각화 (MVP)
> 📖 상세 계획: [implementation_plan_time_tracking.md](implementation_plan_time_tracking.md) | 태스크: [task_time_tracking.md](task_time_tracking.md)
- [ ] **업무 라이프사이클 타임스탬프 기록**
  - '진행중' 및 '완료' 시점의 시간 데이터를 자동으로 수집하여 소요 시간 계산
- [ ] **대시보드 몰입 시간 시각화**
  - 개별 업무 소요 시간 표시 및 오늘 하루 총 집중 시간 요약 카드 구현

### 🥉 우선순위 3: 일정 캘린더 직접 등록 (기존 18단계)
> 📖 상세 계획: [implementation_plan_phase15.md](implementation_plan_phase15.md)
- [ ] **AI 파싱 엔진 통합 및 영수증 OCR 구현**
  - 카드 결제 문자 및 영수증 이미지 자동 분석 로직 이식
- [ ] **개인 드라이브 기반 영수증 아카이빙 연동**
  - 추출된 영수증 이미지를 유저 개인 드라이브 전용 폴더에 자동 저장
- [ ] **지출-업무 태스크 자동 링크 시스템 구축**
  - 지출 내역 저장 시 '지출결의 필요' 태스크를 `Tasks` 시트에 자동 생성
- [ ] **통합 검색 및 모바일 지출 관리 UI 최적화**
  - Judy Note 웹 앱 내 지출 내역 조회 탭 신설 및 글로벌 검색 연동

### 우선순위 7: 팀 온보딩 가이드 및 AI 평가 시스템 (기존 19단계)
> 📖 상세 계획: [implementation_plan_phase19.md](implementation_plan_phase19.md)

#### 🅰️ 주디 사용설명 (팀원 온보딩 가이드)
- [ ] **기능별 사용 가이드 문서 작성**
  - 팀원 온보딩 첫 번째 문서: 전체 기능 목록, 기능별 사용법, 주의사항 정리
- [ ] **QA 기본 문서 및 테스트 방법 안내**
  - 각 기능에 대한 정상/비정상 케이스 검증 절차 문서화
- [ ] **기능별 녹화 화면 제작 및 문서 첨부**
  - 실제 동작 환경에서 기능별 시연 영상 녹화 후 가이드 문서에 임베드

#### 🅱️ 주디 평가 시스템 (AI 학습 데이터 수집)
> 💡 **평가 목적**: 주디 AI 에이전트의 학습 데이터(스코어, 스킬스 문서, 피드백)로 활용하여 지속적 개선

- [ ] **실시간: 슬랙 이모지 리액션 (👍/👎)**
  - 주디의 모든 응답 메시지에 자동으로 리액션 이모지 부착, 팀원이 클릭하면 `FeedbackLog` 시트에 자동 기록 (마찰 제로)
- [ ] **주간: 슬랙 내 미니 설문**
  - 매주 금요일 주디가 DM으로 "이번 주 가장 유용했던 기능은?" + 버튼 선택 전송, 30초 내 완료
- [ ] **패시브: 기능별 사용 빈도 + 에러 자동 로깅**
  - 각 기능 호출 시 `FeedbackLog` 시트에 자동 기록 (누가, 언제, 어떤 기능, 성공/실패), 에러 발생 시 원인 자동 추적

---

## 🔮 향후 서버 고도화 방안

> **작성일**: 2026-02-24 | **전환 시점**: 팀 20명 이상 또는 업무 1000건 초과 시 검토

### 현재 아키텍처 (GAS)의 한계

| 문제 | 원인 | 영향 |
|---|---|---|
| 콜드 스타트 2~5초 | GAS 서버리스 특성 | Slack 3초 타임아웃 위험 |
| 비동기 처리 불가 | GAS 언어 제약 | 트리거 사용 시 1~2분 지연 |
| 시트 읽기 속도 | DB 대신 Google Sheets 사용 | 데이터 증가 시 성능 저하 |

### 고도화 단계

**1단계: Cloudflare Workers 미들웨어 (비용: 무료)**
- Slack → Cloudflare Workers (즉시 응답) → GAS (백그라운드)
- 콜드 스타트 0ms, 무료 티어 10만 요청/일
- Google Sheets 그대로 유지, 속도 문제만 해결
- 기존 GAS 코드 최소 수정

**2단계: 풀 서버 전환 (비용: 월 $5~20)**
- Node.js + Google Cloud Run + PostgreSQL
- 응답 0.1~0.3초, 비동기 네이티브 지원
- 모든 제약 해소, 무한 확장 가능
- 기존 Google Sheets 데이터 마이그레이션 필요
