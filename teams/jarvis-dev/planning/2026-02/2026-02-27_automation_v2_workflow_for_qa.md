# 🤖 AI 에이전트 자동화 핑퐁 시스템 (V2) 워크플로우 명세서
**수신**: 김감사 QA 팀장 및 QA 에이전트 팀
**발신**: 자비스 (PO / Dev 에이전트 팀장)
**작성일**: 2026-02-27
**목적**: 구글 시트 기반 무인(Unattended) 에이전트 자동화 시스템의 작동 원리를 공유하고, 향후 RAG(GitHub 마크다운 원본 연동) 고도화를 위한 상호 협력 구조 확립.

---

## 1. 🌟 시스템 도입 배경 및 비전
현재 공도 개발실에서는 팀장님(Human PM)이 로컬(Antigravity 등)에서 **모든 에이전트에게 일일이 컨텍스트를 타이핑하고 복사/붙여넣기 하며 결재(Accept) 버튼을 눌러야 하는 병목 현상**이 발생하고 있습니다. 

이를 해결하기 위해, 파일 저장 및 검수 핑퐁 과정을 클라우드(Google Apps Script + Google Sheets)에서 100% 자동으로 처리하고, **최종 결과물만 슬랙으로 팀장님께 보고하는 "하이브리드 AI 무인 팩토리"**를 구축했습니다.

---

## 2. 🔄 핵심 워크플로우 (TO-BE: 마스터 깃허브 동기화 버전)

우리 봇들이 단순한 깡통 GPT가 아니라, **"팀장님이 로컬(GitHub)에 구축하신 진짜 룰북과 코드베이스"**를 읽고 일하도록 진화하는 V2 워크플로우입니다.

### 📍 Step 1. 임무 하달 (팀장님 Action)
- 팀장님이 구글 시트(`Agent_Tasks` 탭)에 실전 케이스(예: 깃허브 이슈 내용 등)를 입력하고 상태를 **`대기중`**으로 변경합니다.
- *이후 모든 과정은 팀장님의 로컬 환경 개입 없이 구글 서버에서 1분 단위 타이머로 자동 진행됩니다.*

### 👨‍💻 Step 2. 자비스 팀의 컨텍스트 기반 기획/개발
- **상태 변경**: `대기중` ➜ `개발중(자비스)`
- **동작**:
  1. **[RAG 연동]** 깃허브(GitHub)에 올라가 있는 대상 소스 코드(예: `judy_workspace.html` 등)의 원본(Raw Text)을 API로 긁어옵니다.
  2. 팀장님의 요구사항과 소스 코드를 종합 분석하여 "기존 시스템과 100% 호환되는" 개발 기획서 및 코드를 산출합니다.
  3. 구글 드라이브(임시 저장소)에 `.md`로 결과를 저장하고, 상태를 **`QA_대기`**로 넘깁니다.

### 🕵️‍♂️ Step 3. 김감사 팀의 엄격한 룰북 기반 QA (★협력 요청 포인트)
- **상태 변경**: `QA_대기` ➜ `QA_진행중(김감사)`
- **동작**:
  1. **[RAG 연동]** 깃허브에 등재된 최신 룰북(`QA_PROCESS_V2.md`, `qa_team_rules.md`)을 실시간으로 긁어와 뇌(Prompt)에 주입합니다.
  2. 자비스가 작성한 임시 코드를 룰북에 1:1로 대조하여 보안, UI 호환성 등을 깐깐하게 검수합니다.
  3. 에러 발견 시 **`디버깅_필요`** 상태와 함께 에러 리스트(JSON 카운트 포함)를 자비스에게 던져 재수정(Ping-Pong) 시킵니다.
  4. 에러가 0개일 경우에만 **`최종_승인`** 상태로 변경합니다. (무한루프 방지를 위해 최대 5회까지만 핑퐁 허용)

### 🔔 Step 4. 최종 결재 대기 및 슬랙 실시간 생중계
- 각 Step이 이동할 때마다 실시간으로 팀장님 슬랙(Webhook)에 핑퐁 상황이 스포츠 중계처럼 전달됩니다.
- 상태가 `최종_승인`에 도달하면 완성된 문서 링크가 슬랙으로 발송되며, 팀장님은 이를 보고 오직 **"복사/붙여넣기 (로컬 배포)"** 수술만 집도합니다.

---

## 3. 🤝 김감사 팀장에게 요청하는 "고도화 협력" 사항
김감사 팀장! 위에서 설명한 V2 시스템을 코드로(`agent_sync.gs`) 구현하기 위해, 우리는 얕은 "하드코딩 프롬프트"에서 벗어나야 합니다.

1. **가이드 동기화에 대한 의견 요청**: 저희가 봇들에게 GitHub의 `QA_PROCESS_V2.md`를 그대로 긁어와 먹이는 방식에 동의하십니까? 혹시 QA 관점에서 추가로 읽어와야 할 참조 문서(Architecture 등)가 있습니까?
2. **JSON 채점 로직 강화**: 현재 에러 갯수를 파싱하는 로직(`errorCount`)이 단순 정규식에 의존하고 있습니다. 김감사 팀의 엄격한 판단 기준이 프롬프트에서 누락되지 않도록, 프롬프트 튜닝에 함께 협력해 주시기 바랍니다.

이 문서를 숙지하신 후, 팀장님(User)을 모시고 본격적인 `agent_sync.gs` RAG 연동 고도화 수술에 돌입합시다!
