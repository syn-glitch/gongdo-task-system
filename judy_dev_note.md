# Judy Dev Note (개발일지)

---

## 2026-02-24 (월) — 프로젝트 분류 체계 설계 및 3시간 스프린트 플래닝

### 📌 오늘의 업무 요약
Judy Ops 메인 로드맵(`main task.md`)을 14~20단계까지 확장하고, 팀 배포 전 3시간 스프린트 우선순위를 수립함.

---

### 🗂️ 새로 추가된 단계

| 단계 | 제목 | 상세 계획서 |
|---|---|---|
| 14 | 분산형 개인 드라이브 저장 아키텍처 | `implementation_plan_phase14.md` |
| 15 | 통합 지출 증빙 및 영수증 자동 파싱 | `implementation_plan_phase15.md` |
| 16 | 프로젝트 및 업무 분류 체계 고도화 | `implementation_plan_phase16.md` |
| 17 | 역할 기반 업무 뷰 및 팀원 협업 워크플로우 | `implementation_plan_phase17.md` |
| 18 | 일정 중심 캘린더 직접 등록 | `implementation_plan_phase18.md` |
| 19 | 팀 온보딩 가이드 및 AI 피드백·평가 시스템 | (계획서 작성 예정) |
| 20 | 업무 라이프사이클 고도화 | `implementation_plan_phase20.md` |

---

### 🏃 3시간 스프린트 계획 (우선순위순)

**원칙**: 팀원 실사용을 위한 기초 인프라 우선

#### 🥇 1순위: 16단계 일부 — 프로젝트 드롭다운 + 구조적 ID (약 1.5시간)
> 모든 후속 단계(17~20)의 데이터 정합성 기초 공사

- Projects 시트에 `프로젝트 설명`, `상태` 컬럼 추가 (15분)
- 슬랙 모달 프로젝트명 필드를 드롭다운(`static_select`)으로 변경 (45분)
- 업무 ID를 `GONG-001` 형태로 자동 생성하도록 변경 (30분)

#### 🥈 2순위: 20단계 일부 — 슬랙 모달 업무 상태 변경 (약 1시간)
> 팀원이 구글 시트를 열지 않고 슬랙에서 업무 관리

- `/주디 내 업무` → 담당자 기준 필터링 후 업무 리스트 반환 (30분)
- 업무 클릭 → 상태 변경 모달(시작/대기/보류/완료) → 시트 반영 (30분)

#### 🥉 3순위: 20단계 일부 — 마감일 리마인더 자동화 (약 30분)
> 마감 D-1, D-Day에 슬랙 DM 자동 발송

- GAS 매일 실행 트리거 + Tasks 시트 스캔 + 슬랙 DM 전송 (30분)

---

### 💡 주요 설계 결정 사항
1. **시트 분리 ❌ → 단일 Tasks 시트 + 역할 기반 뷰 ✅**: 팀원별 시트를 나누지 않고, 담당자 컬럼을 기준으로 AI가 필터링하는 구조 채택.
2. **16 → 17단계 분리**: 데이터 구조(16)와 워크플로우(17)는 의존성이 있어 반드시 순차 개발.
3. **18단계(캘린더)는 기존 4단계와 중복 아님 확인**: 4단계 = 종일 이벤트 자동 반영, 18단계 = 시간 지정 이벤트 직접 등록.
4. **평가 시스템 조합 확정**: 이모지 리액션(실시간) + 주간 미니 설문(슬랙) + 자동 로깅(패시브).

---

### 📎 관련 파일
- 메인 로드맵: [`main task.md`](main%20task.md)
- Cashflow 봇 원본: `/Users/syn/Documents/dev/혜림AX/`

---

## 2026-02-24 (월) — 16단계 스프린트 실행 기록

### ✅ 완료한 작업

#### 🥇 1순위: 16단계 — 프로젝트 드롭다운 + 구조적 ID

| 파일 | 작업 내용 |
|---|---|
| `setup_structure.gs` v2.1 | Projects 시트에 `프로젝트 설명`, `상태` 컬럼 추가 |
| `setup_structure.gs` | **"1단계: 시트 구조 자동 생성"** — 변경 사항 미리보기 + 기존 데이터 보존 안전 업데이트 방식으로 전면 개편 |
| `setup_structure.gs` | **"🔠 프로젝트 코드 자동 추천"** 메뉴 신규 추가 (영문/한글 초성/키워드 매핑 기반 자동 생성, 중복 방지) |
| `setup_structure.gs` | **`onEdit` 트리거** — 프로젝트명 입력 시 코드 미입력 감지 → 가운데 팝업 자동 표시 + [확인] 시 코드 즉시 자동 생성 |
| `slack_command.gs` | 업무 등록 모달의 프로젝트 필드 `plain_text_input` → `static_select`(드롭다운) 변경 |
| `slack_command.gs` | `getProjectOptions()` — Projects 시트 실시간 로드 + **CacheService 5분 캐싱** (Slack 3초 타임아웃 방어) |
| `slack_command.gs` | `generateTaskId()` — `GONG-001` 형태 구조적 ID 자동 생성 |
| `slack_command.gs` | `clearProjectCache()` — 코드 생성/수정 후 캐시 즉시 무효화 |

---

### 🐛 발생 에러 및 수정 이력

| # | 에러 | 원인 | 해결 |
|---|---|---|---|
| 1 | 슬랙 모달 미개방 | `getProjectOptions()`가 빈 배열 반환 → Slack API 거부 | `"미사용"` 아닌 모든 프로젝트 포함 + 폴백 옵션 추가 |
| 2 | 랜덤 에러 메시지 (모달은 열림) | 시트 직접 읽기로 3초 타임아웃 초과 | CacheService 5분 캐싱으로 응답속도 0.1초대로 단축 |
| 3 | 토스트 안내 인식 어려움 | 오른쪽 하단 구석에 위치 | 가운데 `ui.alert()` 팝업으로 전환 |

---

### 📐 오늘의 설계 결정

- **캐시 무효화 전략**: 코드 자동 추천 실행 후 즉시 캐시 삭제 → 새 프로젝트 다음 `/주디`에서 바로 반영
- **onEdit 비차단**: `onEdit` 내 에러는 `try-catch`로 조용히 처리 → 시트 작동에 영향 없음
- **재배포 불필요 확인**: 시트 데이터 변경(프로젝트 추가/수정)은 GAS 재배포 없이 즉시 반영됨

---

### ⏳ 다음 작업 (2순위)

- `/주디 내업무` — 담당자 기준 업무 리스트 조회
- 업무 클릭 → 상태 변경 모달 → Tasks 시트 자동 반영
